location.query={};var query=location.search.replace("?","").split("&");for(const e of query){var qq=e.split("=");2==qq.length&&""!=qq[1]?location.query[qq[0]]=qq[1]:1==qq.length&&""!=qq[0]&&(location.query[qq[0]]=!0)}function buildSearchString(e){var a=[];for(var t in e)!0===e[t]?a.push(t):a.push(t+"="+e[t]);return"?"+a.join("&")}$("#menu-toggle").click((function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")})),$.getJSON("/api/inftalks/guild/all",(function(e){for(var a in e){var t=e[a].guild;$("<li/>",{html:'<a href="/guild.html?id='+t.id+'">'+t.name+"</a>"}).appendTo("#sidebar_guilds")}}));var guidData={},localGuidData={},selectedCategory=null,selectedTChannel=null;function loadGuildData(){$.getJSON("/api/inftalks/guild?id="+location.query.id,(function(e){localGuidData=e,guidData=$.extend(!0,{},localGuidData),localGuidData.guild.categorys.length>0&&(selectedCategory=localGuidData.guild.categorys[0]),localGuidData.guild.textChannels.length>0&&(selectedTChannel=localGuidData.guild.textChannels[0]),updateData()}))}function saveGuildData(){guidData=$.extend(!0,{},localGuidData),updateData()}function updateData(){$(".var_guild").each((function(){this.innerText=localGuidData.guild.name}));var e=$("#setting_language");for(var a of(e.empty(),localGuidData.langlist))if("default"!=a.key){var t=$("<option/>").attr("value",a.langShort).text(a.langName);localGuidData.guild.language==a.key&&t.attr("selected"),t.appendTo(e)}$("#setting_prefix").attr("value",localGuidData.guild.prefix);var l=$("#setting_category");for(var n of(l.empty(),localGuidData.guild.categorys)){t=$("<option/>").attr("value",n.id).text(n.name);n.id==selectedCategory.id&&t.attr("selected",!0),t.appendTo(l)}$("#setting_category_enable").attr("checked",selectedCategory.enableInfTalks),$("#setting_category_allowLock").val(selectedCategory.allowLock).attr("disabled",!selectedCategory.enableInfTalks),$("#setting_category_allowLock_wrapper")[selectedCategory.enableInfTalks?"removeClass":"addClass"]("disabled"),$("#setting_category_channelLimit").val(selectedCategory.channelLimit).attr("disabled",!selectedCategory.enableInfTalks)[selectedCategory.enableInfTalks?"removeClass":"addClass"]("disabled"),$("#setting_category_channelUserLimit").val(selectedCategory.channelUserLimit).attr("disabled",!selectedCategory.enableInfTalks)[selectedCategory.enableInfTalks?"removeClass":"addClass"]("disabled"),$("#setting_category_namingRule").val(selectedCategory.namingRule).attr("disabled",!selectedCategory.enableInfTalks)[selectedCategory.enableInfTalks?"removeClass":"addClass"]("disabled"),isEquivalent(localGuidData.guild,guidData.guild)?$("#snackbar").removeClass("show"):$("#snackbar").addClass("show")}function isEquivalent(e,a){var t=Object.getOwnPropertyNames(e),l=Object.getOwnPropertyNames(a);if(t.length!=l.length)return!1;for(var n=0;n<t.length;n++){var i=t[n];if(typeof e[i]!=typeof a[i])return!1;if("object"==typeof e[i])return isEquivalent(e[i],a[i]);if(e[i]!=a[i])return!1}return!0}"/guild.html"==location.pathname&&($("#save_button").click((function(e){e.preventDefault(),saveGuildData()})),$("#undo_button").click((function(e){e.preventDefault(),localGuidData=$.extend(!0,{},guidData),updateData()})),$(".settings.value").each((function(){$(this).change((function(e){var a=$(e.currentTarget);switch(a.attr("id")){case"setting_language":localGuidData.guild.language=""+a.val();break;case"setting_prefix":localGuidData.guild.prefix=""+a.val();break;case"setting_category":selectedCategory=null,selectedCategory=localGuidData.guild.categorys.find((function(e){return e.id==a.val()}));break;case"setting_category_enable":selectedCategory.enableInfTalks=a.is(":checked");break;case"setting_category_allowLock":selectedCategory.allowLock=a.is(":checked");break;case"setting_category_channelLimit":selectedCategory.channelLimit=""+a.val();break;case"setting_category_channelUserLimit":selectedCategory.channelUserLimit=""+a.val();break;case"setting_category_namingRule":selectedCategory.namingRule=""+a.val()}updateData()}))})),loadGuildData());